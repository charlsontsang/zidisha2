<?xml version="1.0" encoding="UTF-8"?>
<database name="zidisha" defaultIdMethod="native" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:noNamespaceSchemaLocation="http://xsd.propelorm.org/1.6/database.xsd" namespace="Zidisha\">
    <table name="users" phpName="User" namespace="User">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="username" type="VARCHAR" size="20" required="true" />
        <column name="email" type="VARCHAR" size="100" required="true" />
        <column name="password" type="VARCHAR" size="60" required="false" />
        <column name="facebook_id" type="BIGINT" required="false" />
        <column name="remember_token" type="VARCHAR" size="100" required="false" />
        <column name="role" type="ENUM" valueSet="lender, borrower" />
        <column name="last_login_at" type="TIMESTAMP" required="true" />
        <behavior name="timestampable" />
        <unique>
            <unique-column name="username" />
        </unique>
        <unique>
            <unique-column name="email"></unique-column>
        </unique>
    </table>

    <table name="loan_categories" phpName="Category" namespace="Loan">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="VARCHAR" size="100" required="true"/>
        <column name="what_description" type="LONGVARCHAR" required="false"/>
        <column name="why_description" type="LONGVARCHAR" required="false"/>
        <column name="how_description" type="LONGVARCHAR" required="false"/>
        <column name="admin_only" type="BOOLEAN" defaultValue="FALSE"/>
        <behavior name="timestampable"/>
        <behavior name="sortable"/>
    </table>

    <table name="countries" phpName="Country" namespace="Country">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="VARCHAR" size="100" defaultValue="NULL"/>
        <column name="continent_code" type="VARCHAR" size="2" defaultValue="NULL"/>
        <column name="country_code" type="VARCHAR" size="2" defaultValue="NULL"/>
        <column name="dialing_code" type="VARCHAR" size="4" defaultValue="NULL"/>
        <column name="enabled" type="BOOLEAN"/>
        <index name="name">
            <index-column name="name" />
        </index>
        <index name="code">
            <index-column name="country_code" />
        </index>
        <behavior name="timestampable"/>
    </table>

    <table name="loan" phpName="Loan" namespace="Loan">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="borrower_id" type="INTEGER" primaryKey="true"/>"
        <column name="summary" type="LONGVARCHAR"/>
        <column name="description" type="LONGVARCHAR"/>
        <column name="amount" type="DECIMAL" size="10" scale="2"/>
        <column name="installment_amount" type="DECIMAL" size="10" scale="2"/>
        <column name="installment_day" type="INTEGER"/>
        <column name="interest_rate" type="DECIMAL" size="5" scale="2"/>
        <column name="loan_category_id" type="INTEGER" required="true"/>
        <behavior name="timestampable"/>
        <foreign-key foreignTable="loan_categories">
            <reference local="loan_category_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="borrowers">
            <reference local="borrower_id" foreign="id"/>
        </foreign-key>
    </table>

    <table name="password_reminders" phpName="PasswordReminder" namespace="PasswordReminder">
        <column name="email" type="VARCHAR" size="100" required="true" />
        <column name="token" type="VARCHAR" size="100" required="true" />
        <behavior name="timestampable" />
        <index name="email">
            <index-column name="email" />
        </index>
        <index name="token">
            <index-column name="token" />
        </index>
    </table>
    
    <table name="lenders" phpName="Lender" namespace="Lender">
        <column name="id" type="INTEGER" primaryKey="true" />
        <column name="country_id" type="INTEGER" required="true"/>
        <column name="first_name" type="VARCHAR" size="50" required="true" />
        <column name="last_name" type="VARCHAR" size="50" required="true" />
        <behavior name="timestampable" />
        <foreign-key foreignTable="users">
            <reference local="id" foreign="id"/>
        </foreign-key>
        <foreign-key foreignTable="countries">
            <reference local="country_id" foreign="id"/>
        </foreign-key>
    </table>

    <table name="borrowers" phpName="Borrower" namespace="Borrower">
        <column name="id" type="INTEGER" primaryKey="true" />
        <column name="country_id" type="INTEGER" required="true"/>
        <column name="first_name" type="VARCHAR" size="50" required="true" />
        <column name="last_name" type="VARCHAR" size="50" required="true" />
        <behavior name="timestampable" />
        <foreign-key foreignTable="users">
            <reference local="id" foreign="id"/>
        </foreign-key>
        <foreign-key foreignTable="countries">
            <reference local="country_id" foreign="id"/>
        </foreign-key>
    </table>

    <table name="borrower_profiles" phpName="Profile" namespace="Borrower">
        <column name="borrower_id" type="INTEGER" primaryKey="true"/>
        <column name="about_me" type="LONGVARCHAR" />
        <column name="about_business " type="LONGVARCHAR" />
        <behavior name="timestampable" />
        <foreign-key foreignTable="borrowers">
            <reference local="borrower_id" foreign="id"/>
        </foreign-key>
    </table>

    <table name="lender_profiles" phpName="Profile" namespace="Lender">
        <column name="lender_id" type="INTEGER" primaryKey="true"/>
        <column name="about_me" type="LONGVARCHAR" />
        <behavior name="timestampable" />
        <foreign-key foreignTable="lenders">
            <reference local="lender_id" foreign="id"/>
        </foreign-key>
    </table>
</database>
